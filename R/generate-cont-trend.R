#' Generate the continental trend
#'
#' \code{generate_cont_trend} calculates the geometric mean annual changes in population size.
#'
#' @param indices Continental indices generated by \code{generate_cont_indices}
#' @param min_year Minimum year to calculate trends from
#' @param max_year Maximum year to calculate trends to
#'
#' @return Numeric percentage of trend
#'
#' @examples
#'
#' \dontrun{
#' # Run a JAGS model analysis on a species
#' stratified_data <- stratify(bbs_data = fetch_bbs_data(), stratify_by = "bcr")
#' prepped_data <- prepare_jags_data(strat_data = stratified_data,
#'                                   species_to_run = "Barn Swallow",
#'                                   model = "slope")
#' mod <- run_model(jags_data = prepped_data)
#'
#' #Generate the continental indices weighted by each strata
#' cont_index <- generate_cont_indices(jags_mod = mod)
#'
#' #Output the trend
#' generate_cont_trend(indices = cont_index)
#' }
#'
#' @export
#'

generate_cont_trend <- function(indices = NULL,
                                min_year = NULL,
                                max_year = NULL)
{
  if (is.null(min_year))
  {
    min_year = min(indices$Year)
  }
  if (is.null(max_year))
  {
    max_year = max(indices$Year)
  }

  new_index <- indices[which(indices$Year == max_year), ]$Index
  old_index <- indices[which(indices$Year == min_year), ]$Index

  trend <- 100 * ((new_index/old_index)^(1/(max_year - min_year)) - 1)

  return(trend)
}
